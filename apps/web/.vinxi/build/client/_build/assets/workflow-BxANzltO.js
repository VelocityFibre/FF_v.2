import{b as e,k as Ge,e as O,w as Je,i as u,t as _,l as t,p as l,m as re,F as ne,S as p}from"./web-DY2gxAax.js";import"./PhaseTimeline-pQuIR3I4.js";import{D as C,S as A,I as ie,T as Ke}from"./index-Dtoj-mqw.js";import{m as ve}from"./mockData-D4l3Y6OF.js";import{B as I}from"./badge-DaVJPDeA.js";import{I as Qe,B as f,C as se}from"./ThemeSwitcher-qFUB_xEj.js";import{P as xe}from"./progress-hbeMakjh.js";import{c as Ve}from"./calendar-k80SZwjM.js";import{c as Xe}from"./clock-BGlWFxSn.js";import{p as pe}from"./plus-D4bzuMMg.js";import{s as Ye}from"./settings-CBR9i_7L.js";import{s as Ze}from"./square-pen-B7AK6JZ_.js";import{u as et}from"./user-plus-BODIV9oa.js";import{u as be}from"./user-Br-tLqM2.js";import{h as tt}from"./routing-BTE-NiBa.js";import"./play-BU3iDEd4.js";import"./triangle-alert-vr0RNRgJ.js";var lt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],rt=H=>e(Qe,Ge(H,{name:"ArrowRight",iconNode:lt})),nt=rt,it=_("<div class=space-y-6>"),st=_('<div class="text-center py-8">Loading workflow data...'),at=_('<div class="flex items-start justify-between"><div><h1 class="text-2xl font-bold text-card-foreground mb-2"><!$><!/> - Workflow Management</h1><div class="flex items-center gap-4"><!$><!/><span class=text-muted-foreground><!$><!/>% Complete</span></div></div><div class="flex gap-2"><!$><!/><!$><!/>'),ct=_('<div class="grid grid-cols-1 lg:grid-cols-5 gap-4">'),fe=_("<div class=space-y-4>"),ot=_('<div class=space-y-4><!$><!/><!$><!/><div class="grid grid-cols-2 gap-4"><!$><!/><!$><!/></div><!$><!/>'),gt=_('<div class=text-center><h3 class="font-semibold text-card-foreground mb-2 capitalize"></h3><div class=space-y-3><!$><!/><div class=space-y-1><div class="flex justify-between text-sm"><span>Progress</span><span><!$><!/>%</span></div><!$><!/></div><div class="text-sm text-muted-foreground"><!$><!/> tasks</div><!$><!/>'),dt=_('<div class="flex items-center justify-between mb-6"><h2 class="text-xl font-semibold capitalize text-card-foreground"><!$><!/> Tasks</h2><!$><!/>'),$t=_('<div class="text-center py-8 text-muted-foreground">No tasks in this phase yet. Create your first task to get started.'),ut=_('<p class="text-muted-foreground mb-3">'),_t=_('<span class="flex items-center gap-1"><!$><!/>Assigned to User <!$><!/>'),ht=_('<span class="flex items-center gap-1"><!$><!/>Due <!$><!/>'),mt=_('<span class="flex items-center gap-1"><!$><!/><!$><!/>h estimated'),xt=_('<div class="flex items-start justify-between"><div class=flex-1><div class="flex items-center gap-3 mb-2"><h3 class="font-semibold text-card-foreground"></h3><!$><!/><!$><!/><!$><!/><!$><!/></div><!$><!/><div class="flex items-center gap-6 text-sm text-muted-foreground mb-3"><!$><!/><!$><!/><!$><!/></div><div class="flex items-center justify-between"><div class="flex-1 mr-4"><div class="flex justify-between text-sm mb-1"><span>Progress</span><span><!$><!/>%</span></div><!$><!/></div></div></div><div class="flex items-center gap-2 ml-4"><!$><!/><!$><!/>'),pt=_('<div class="flex items-center gap-2"><!$><!/><span></span><!$><!/>');const bt=H=>{const[R,G]=O(""),[Se,N]=O(!1),[we,J]=O(!1),[z,X]=O(null),[K,ae]=O(null);Je(()=>{const s=ve.getProjectWorkflow(H.projectId);ae(s)});const ce=()=>{const s=K();return s?s.availableUsers:[]},Q=s=>{const c=K();return c?c.tasks.filter(i=>i.phaseId===s):[]},oe=s=>{const c=Q(s);if(c.length===0)return 0;const i=c.filter(n=>n.status==="completed").length;return Math.round(i/c.length*100)},Ce=s=>Q(s.id).filter(n=>n.isBlocking&&n.status!=="completed").length===0,ke=s=>{const c=K();if(!c)return;const i=c.phases.map(n=>n.id===s&&n.status==="active"?{...n,status:"completed"}:n);ae({...c,phases:i})},ye=s=>{switch(s){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"blocked":return"bg-red-100 text-red-800";case"not_started":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Pe=s=>{switch(s){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return(()=>{var s=u(it);return t(s,e(p,{get when(){return K()},get fallback(){return u(st)},children:c=>[(()=>{var i=u(at),n=i.firstChild,o=n.firstChild,g=o.firstChild,[r,m]=l(g.nextSibling);r.nextSibling;var d=o.nextSibling,a=d.firstChild,[h,x]=l(a.nextSibling),b=h.nextSibling,k=b.firstChild,[y,v]=l(k.nextSibling);y.nextSibling;var S=n.nextSibling,T=S.firstChild,[w,U]=l(T.nextSibling),j=w.nextSibling,[F,M]=l(j.nextSibling);return t(o,()=>c().project.name,r,m),t(d,e(I,{variant:"outline",class:"capitalize",get children(){return[re(()=>c().project.currentPhase.replace("_"," "))," Phase"]}}),h,x),t(b,()=>c().project.completionPercentage,y,v),t(S,e(f,{onClick:()=>N(!0),get children(){return[e(pe,{class:"w-4 h-4 mr-2"}),"Add Task"]}}),w,U),t(S,e(f,{variant:"outline",get children(){return[e(Ye,{class:"w-4 h-4 mr-2"}),"Settings"]}}),F,M),i})(),(()=>{var i=u(ct);return t(i,e(ne,{get each(){return c().phases},children:n=>e(se,{get class(){return`p-4 cursor-pointer transition-colors ${R()===n.id?"ring-2 ring-blue-500":""}`},onClick:()=>G(n.id),get children(){var o=u(gt),g=o.firstChild,r=g.nextSibling,m=r.firstChild,[d,a]=l(m.nextSibling),h=d.nextSibling,x=h.firstChild,b=x.firstChild,k=b.nextSibling,y=k.firstChild,[v,S]=l(y.nextSibling);v.nextSibling;var T=x.nextSibling,[w,U]=l(T.nextSibling),j=h.nextSibling,F=j.firstChild,[M,Y]=l(F.nextSibling);M.nextSibling;var V=j.nextSibling,[Z,D]=l(V.nextSibling);return t(g,()=>n.phaseName.replace("_"," ")),t(r,e(I,{variant:"outline",get class(){return n.status==="active"?"bg-blue-50 text-blue-700":""},get children(){return n.status}}),d,a),t(k,()=>oe(n.id),v,S),t(h,e(xe,{get value(){return oe(n.id)},max:100,class:"h-2"}),w,U),t(j,()=>Q(n.id).length,M,Y),t(r,e(p,{get when(){return re(()=>n.status==="active")()&&Ce(n)},get children(){return e(f,{size:"sm",class:"w-full",onClick:ee=>{ee.stopPropagation(),ke(n.id)},get children(){return[e(nt,{class:"w-4 h-4 mr-1"}),"Advance"]}})}}),Z,D),o}})})),i})(),e(p,{get when(){return R()},children:i=>{const n=c().phases.find(g=>g.id===i()),o=Q(i());return e(se,{class:"p-6",get children(){return[(()=>{var g=u(dt),r=g.firstChild,m=r.firstChild,[d,a]=l(m.nextSibling);d.nextSibling;var h=r.nextSibling,[x,b]=l(h.nextSibling);return t(r,()=>n?.phaseName.replace("_"," "),d,a),t(g,e(f,{size:"sm",onClick:()=>{X(null),N(!0)},get children(){return[e(pe,{class:"w-4 h-4 mr-2"}),"Add Task to Phase"]}}),x,b),g})(),(()=>{var g=u(fe);return t(g,e(p,{get when(){return o.length>0},get fallback(){return u($t)},get children(){return e(ne,{each:o,children:r=>e(se,{class:"p-4 hover:shadow-md transition-shadow",get children(){var m=u(xt),d=m.firstChild,a=d.firstChild,h=a.firstChild,x=h.nextSibling,[b,k]=l(x.nextSibling),y=b.nextSibling,[v,S]=l(y.nextSibling),T=v.nextSibling,[w,U]=l(T.nextSibling),j=w.nextSibling,[F,M]=l(j.nextSibling),Y=a.nextSibling,[V,Z]=l(Y.nextSibling),D=V.nextSibling,ee=D.firstChild,[ge,Te]=l(ee.nextSibling),je=ge.nextSibling,[de,De]=l(je.nextSibling),Ae=de.nextSibling,[Ie,Ne]=l(Ae.nextSibling),ze=D.nextSibling,$e=ze.firstChild,ue=$e.firstChild,Me=ue.firstChild,_e=Me.nextSibling,Be=_e.firstChild,[he,He]=l(Be.nextSibling);he.nextSibling;var Ue=ue.nextSibling,[Fe,Ee]=l(Ue.nextSibling),te=d.nextSibling,We=te.firstChild,[me,Le]=l(We.nextSibling),qe=me.nextSibling,[Oe,Re]=l(qe.nextSibling);return t(h,()=>r.taskName),t(a,e(I,{get class(){return ye(r.status)},get children(){return r.status.replace("_"," ")}}),b,k),t(a,e(I,{get class(){return Pe(r.priority)},get children(){return r.priority}}),v,S),t(a,e(p,{get when(){return r.isMilestone},get children(){return e(I,{variant:"secondary",children:"Milestone"})}}),w,U),t(a,e(p,{get when(){return r.isBlocking},get children(){return e(I,{variant:"destructive",children:"Blocking"})}}),F,M),t(d,e(p,{get when(){return r.description},get children(){var $=u(ut);return t($,()=>r.description),$}}),V,Z),t(D,e(p,{get when(){return r.assigneeId},get children(){var $=u(_t),E=$.firstChild,[P,W]=l(E.nextSibling),L=P.nextSibling,B=L.nextSibling,[q,le]=l(B.nextSibling);return t($,e(be,{class:"w-4 h-4"}),P,W),t($,()=>r.assigneeId,q,le),$}}),ge,Te),t(D,e(p,{get when(){return r.dueDate},get children(){var $=u(ht),E=$.firstChild,[P,W]=l(E.nextSibling),L=P.nextSibling,B=L.nextSibling,[q,le]=l(B.nextSibling);return t($,e(Ve,{class:"w-4 h-4"}),P,W),t($,()=>new Date(r.dueDate).toLocaleDateString(),q,le),$}}),de,De),t(D,e(p,{get when(){return r.estimatedHours},get children(){var $=u(mt),E=$.firstChild,[P,W]=l(E.nextSibling),L=P.nextSibling,[B,q]=l(L.nextSibling);return B.nextSibling,t($,e(Xe,{class:"w-4 h-4"}),P,W),t($,()=>r.estimatedHours,B,q),$}}),Ie,Ne),t(_e,()=>r.completionPercentage,he,He),t($e,e(xe,{get value(){return r.completionPercentage},max:100,class:"h-2"}),Fe,Ee),t(te,e(f,{size:"sm",variant:"outline",onClick:()=>{X(r),J(!0)},get children(){return e(et,{class:"w-4 h-4"})}}),me,Le),t(te,e(f,{size:"sm",variant:"outline",onClick:()=>{X(r),N(!0)},get children(){return e(Ze,{class:"w-4 h-4"})}}),Oe,Re),m}})})}})),g})()]}})}}),e(p,{get when(){return we()},get children(){return e(C.Content,{onOpenChange:()=>J(!1),get children(){return[e(C.Header,{get children(){return[e(C.Title,{children:"Assign Task"}),e(C.Description,{get children(){return['Assign "',re(()=>z()?.taskName),'" to a team member']}})]}}),(()=>{var i=u(fe);return t(i,e(p,{get when(){return ce()},get children(){return e(A,{placeholder:"Select team member",get children(){return e(ne,{get each(){return ce()},children:n=>e(A.Item,{get value(){return n.id},get children(){var o=u(pt),g=o.firstChild,[r,m]=l(g.nextSibling),d=r.nextSibling,a=d.nextSibling,[h,x]=l(a.nextSibling);return t(o,e(be,{class:"w-4 h-4"}),r,m),t(d,()=>n.name),t(o,e(I,{variant:"outline",class:"ml-auto",get children(){return n.role.replace("_"," ")}}),h,x),o}})})}})}})),i})(),e(C.Footer,{get children(){return[e(f,{variant:"outline",onClick:()=>J(!1),children:"Cancel"}),e(f,{onClick:()=>{J(!1)},children:"Assign Task"})]}})]}})}}),e(p,{get when(){return Se()},get children(){return e(C.Content,{onOpenChange:()=>N(!1),get children(){return[e(C.Header,{get children(){return e(C.Title,{get children(){return z()?"Edit Task":"Create New Task"}})}}),(()=>{var i=u(ot),n=i.firstChild,[o,g]=l(n.nextSibling),r=o.nextSibling,[m,d]=l(r.nextSibling),a=m.nextSibling,h=a.firstChild,[x,b]=l(h.nextSibling),k=x.nextSibling,[y,v]=l(k.nextSibling),S=a.nextSibling,[T,w]=l(S.nextSibling);return t(i,e(ie,{placeholder:"Task name",get value(){return z()?.taskName||""}}),o,g),t(i,e(Ke,{placeholder:"Task description",get value(){return z()?.description||""}}),m,d),t(a,e(A,{placeholder:"Priority",get children(){return[e(A.Item,{value:"low",children:"Low"}),e(A.Item,{value:"medium",children:"Medium"}),e(A.Item,{value:"high",children:"High"}),e(A.Item,{value:"critical",children:"Critical"})]}}),x,b),t(a,e(ie,{type:"date",placeholder:"Due date"}),y,v),t(i,e(ie,{type:"number",placeholder:"Estimated hours",get value(){return z()?.estimatedHours||""}}),T,w),i})(),e(C.Footer,{get children(){return[e(f,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e(f,{onClick:()=>{N(!1)},get children(){return z()?"Update Task":"Create Task"}})]}})]}})}})]})),s})()};var ft=_("<div class=ff-page-container>");const Ut=()=>{const H=tt(),R=ve.getCurrentUser("project_manager");return(()=>{var G=u(ft);return t(G,e(bt,{get projectId(){return H.id},currentUser:R})),G})()};export{Ut as default};
